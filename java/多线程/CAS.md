# CAS 总线锁定和缓存一致性

## 缓存机制和缓存不一致性

CPU 和物理内存之间的通行速度远远小于 CPU 的处理速度，所以 CPU 内部有自己的缓存。

（详见多层缓存机制）根据一些规则将内存中的数据读取到内部缓存中来，以加快频繁读取的速度。

假设在一台 PC 上只有一个 CPU 和一份内部缓存，那么所有进程和线程看到的数都是缓存里的数，不会存在问题。但现在的设备大多数都是多核 CPU，更普遍的是，每块 CPU 中有多个内核，而每个内核都维护了自己的缓存结构（也就是说有一级缓存，二级缓存。。。）。那么这时候就会产生缓存不一致性，

## CAS

这里有一个 MESI 协议：

M: MODIFIED.

E: EXCLUSIVE

S: SHARED

I: INVALID

